<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–∞ | –¢–æ–∫–∞—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</title>
    <style>
        body {
            background-color: #525659; /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ –∫–∞–∫ –≤ Word/Acrobat */
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨ - –í–í–û–î */
        .sidebar {
            width: 350px;
            background: #2c3e50;
            color: white;
            padding: 20px;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .sidebar h2 { margin-top: 0; font-size: 1.2rem; border-bottom: 1px solid #7f8c8d; padding-bottom: 10px; }
        
        .input-group { display: flex; flex-direction: column; gap: 5px; }
        .input-group label { font-size: 0.9rem; color: #bdc3c7; }
        .input-group input, .input-group select {
            padding: 8px;
            border-radius: 4px;
            border: none;
            font-family: monospace;
        }

        .btn-generate {
            background: #27ae60;
            color: white;
            border: none;
            padding: 15px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            border-radius: 5px;
            margin-top: 10px;
            transition: 0.2s;
        }
        .btn-generate:hover { background: #2ecc71; }

        .btn-print {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px;
            cursor: pointer;
            border-radius: 5px;
        }

        /* –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨ - –û–¢–ß–ï–¢ (–õ–ò–°–¢ –ê4) */
        .preview-area {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
            display: flex;
            justify-content: center;
        }

        .a4-page {
            background: white;
            width: 210mm;
            min-height: 297mm;
            padding: 20mm;
            box-sizing: border-box;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            color: black;
            font-family: "Times New Roman", serif;
            font-size: 14pt;
            line-height: 1.3;
        }

        /* –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –æ—Ç—á–µ—Ç–∞ */
        .report-header { font-weight: bold; margin-bottom: 15px; }
        .report-section { margin-bottom: 10px; }
        .formula { font-style: italic; }
        .sub { vertical-align: sub; font-size: 0.7em; }
        .sup { vertical-align: super; font-size: 0.7em; }
        
        /* –°–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø—Ä–∏ –ø–µ—á–∞—Ç–∏ */
        @media print {
            body { background: white; height: auto; display: block; }
            .sidebar { display: none; }
            .preview-area { display: block; padding: 0; }
            .a4-page { width: 100%; box-shadow: none; margin: 0; padding: 0; }
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <h2>üõ†Ô∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø–µ—Ä–∞—Ü–∏–∏</h2>
        
        <div class="input-group">
            <label>–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ (–°—Ç–∞–Ω–æ–∫):</label>
            <input type="text" id="machine" value="–¢–æ–∫–∞—Ä–Ω–æ-–≤–∏–Ω—Ç–æ—Ä–µ–∑–Ω—ã–π —Å—Ç–∞–Ω–æ–∫ 1–ö62">
        </div>
        <div class="input-group">
            <label>–ú–æ—â–Ω–æ—Å—Ç—å —Å—Ç–∞–Ω–∫–∞ (N—Å—Ç), –∫–í—Ç:</label>
            <input type="number" id="N_st" value="10">
        </div>
        <div class="input-group">
            <label>–ü–µ—Ä–µ—Ö–æ–¥ (–æ–ø–∏—Å–∞–Ω–∏–µ):</label>
            <input type="text" id="transition" value="–ü–æ–¥—Ä–µ–∑–∞—Ç—å —Ç–æ—Ä–µ—Ü –ê, –≤—ã–¥–µ—Ä–∂–∞–≤ —Ä-—Ä 18">
        </div>
        <div class="input-group">
            <label>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:</label>
            <input type="text" id="tool" value="–†–µ–∑–µ—Ü –ø—Ä–æ—Ö–æ–¥–Ω–æ–π –æ—Ç–æ–≥–Ω—É—Ç—ã–π —Å –í–ö6">
        </div>

        <hr style="border-color: #7f8c8d; width: 100%;">

        <div class="input-group">
            <label>–ì–ª—É–±–∏–Ω–∞ —Ä–µ–∑–∞–Ω–∏—è (t), –º–º:</label>
            <input type="number" id="t" value="2.0" step="0.1">
        </div>
        <div class="input-group">
            <label>–ü–æ–¥–∞—á–∞ (S), –º–º/–æ–±:</label>
            <input type="number" id="s" value="0.84" step="0.01">
        </div>
        <div class="input-group">
            <label>–î–∏–∞–º–µ—Ç—Ä –¥–µ—Ç–∞–ª–∏ (D), –º–º:</label>
            <input type="number" id="D" value="92" step="1">
        </div>
        <div class="input-group">
            <label>–î–ª–∏–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (L), –º–º:</label>
            <input type="number" id="L" value="18" step="1">
        </div>

        <button class="btn-generate" onclick="updateReport()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç—á–µ—Ç</button>
        <button class="btn-print" onclick="window.print()">üñ®Ô∏è –ü–µ—á–∞—Ç—å / PDF</button>
    </div>

    <div class="preview-area">
        <div class="a4-page" id="report-content">
            </div>
    </div>

<script>
    // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ–±–æ—Ä–æ—Ç—ã 1–ö62
    const SPEEDS_1K62 = [12.5, 16, 20, 25, 31.5, 40, 50, 63, 80, 100, 125, 160, 200, 250, 315, 400, 500, 630, 800, 1000, 1250, 1600, 2000];

    function getNearestSpeed(n) {
        return SPEEDS_1K62.reduce((prev, curr) => Math.abs(curr - n) < Math.abs(prev - n) ? curr : prev);
    }

    function updateReport() {
        // 1. –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
        const machine = document.getElementById('machine').value;
        const N_st = parseFloat(document.getElementById('N_st').value);
        const transition = document.getElementById('transition').value;
        const tool = document.getElementById('tool').value;
        
        const t = parseFloat(document.getElementById('t').value);
        const s = parseFloat(document.getElementById('s').value);
        const D = parseFloat(document.getElementById('D').value);
        const L = parseFloat(document.getElementById('L').value);

        // 2. –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã (–∫–∞–∫ –≤ —Ç–≤–æ–µ–º –ø—Ä–∏–º–µ—Ä–µ)
        const Cv = 420, m = 0.2, x = 0.15, y = 0.2;
        const T_life = 90;
        
        // K_v (–ü–æ–ø—Ä–∞–≤–æ—á–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏)
        // –ü—Ä–∏–º–µ—Ä–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Å–æ—Å—Ç–∞–≤–Ω–æ–≥–æ Kv (Kmp * Kmu * ...)
        // –ë–µ—Ä–µ–º –∏—Ç–æ–≥–æ–≤—ã–π Kv –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –∏–ª–∏ —Å—á–∏—Ç–∞–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω–æ
        const K_v = 1.08; // –ö–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ (–∏–ª–∏ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ä–∞—Å—á–µ—Ç)

        // 3. –†–∞—Å—á–µ—Ç –°–∫–æ—Ä–æ—Å—Ç–∏ (V —Ä–∞—Å—á)
        // –§–æ—Ä–º—É–ª–∞: V = Cv / (T^m * t^x * s^y) * Kv
        const denominator = Math.pow(T_life, m) * Math.pow(t, x) * Math.pow(s, y);
        const V_calc = (Cv / denominator) * K_v;

        // 4. –†–∞—Å—á–µ—Ç –û–±–æ—Ä–æ—Ç–æ–≤ (n —Ä–∞—Å—á)
        const n_calc = (1000 * V_calc) / (Math.PI * D);

        // 5. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ç–∞–Ω–∫—É
        const n_st = getNearestSpeed(n_calc);
        const s_st = s; // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ –ø–æ–¥–∞—á–∞ –µ—Å—Ç—å –Ω–∞ —Å—Ç–∞–Ω–∫–µ

        // 6. –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
        const V_act = (Math.PI * D * n_st) / 1000;

        // 7. –°–∏–ª–∞ —Ä–µ–∑–∞–Ω–∏—è Pz
        // Pz = 10 * Cp * t^x * s^y * V^n * Kp
        const Cp = 300, x_p = 1.0, y_p = 0.75, n_p = 0.15;
        const Kp = 1.0;
        
        // –í–ê–ñ–ù–û: –í —Ç–≤–æ–µ–º –ø—Ä–∏–º–µ—Ä–µ Pz –∑–∞–≤–∏—Å–∏—Ç –æ—Ç V^n (–æ–±—ã—á–Ω–æ V –≤ —Å—Ç–µ–ø–µ–Ω–∏ n_p)
        const Pz = 10 * Cp * Math.pow(t, x_p) * Math.pow(s, y_p) * Math.pow(V_act, n_p) * Kp;

        // 8. –ú–æ—â–Ω–æ—Å—Ç—å —Ä–µ–∑–∞–Ω–∏—è
        // N—Ä–µ–∑ = (Pz * V) / (1020 * 60)
        const N_rez = (Pz * V_act) / (1020 * 60);

        // 9. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è
        // To = L_total / (n * s)
        const l_rez = 1.2; // –≤—Ä–µ–∑–∞–Ω–∏–µ
        const l_per = 1.0; // –ø–µ—Ä–µ–±–µ–≥
        const L_total = L + l_rez + l_per;
        const T_o = L_total / (n_st * s_st);

        // ==========================================
        // –ì–ï–ù–ï–†–ê–¶–ò–Ø HTML –û–¢–ß–ï–¢–ê
        // ==========================================
        
        const html = `
            <div class="report-header">
                I –æ–ø–µ—Ä–∞—Ü–∏—è: –¢–û–ö–ê–†–ù–ê–Ø<br>
                –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ: ${machine}, N<span class="sub">—Å—Ç</span>=${N_st} –∫–í—Ç.<br>
                –ü—Ä–∏—Å–ø–æ—Å–æ–±–ª–µ–Ω–∏–µ: 3—Ö-–∫—É–ª–∞—á–∫–æ–≤—ã–π –ø–∞—Ç—Ä–æ–Ω.<br>
                1 –ø–µ—Ä–µ—Ö–æ–¥: ${transition}.<br>
                –†–µ–∂—É—â–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: ${tool}, –ì–û–°–¢ 18880-70.
            </div>

            <div class="report-section">
                <strong>1. –ì–ª—É–±–∏–Ω–∞ —Ä–µ–∑–∞–Ω–∏—è:</strong> t = z<span class="sub">1max</span> = ${t} –º–º
            </div>

            <div class="report-section">
                <strong>2. –ü–æ–¥–∞—á–∞:</strong> S = ${s} –º–º/–æ–±
            </div>

            <div class="report-section">
                <strong>3. –î–æ–ø—É—Å–∫–∞–µ–º–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–∑–∞–Ω–∏—è:</strong><br>
                <br>
                V = <span class="formula">C<span class="sub">v</span> / (T<span class="sup">m</span> ¬∑ t<span class="sup">x</span> ¬∑ S<span class="sup">y</span>) ¬∑ K<span class="sub">v</span></span>, –º/–º–∏–Ω<br>
                <br>
                –≥–¥–µ: T = ${T_life} –º–∏–Ω ‚Äî —Å—Ç–æ–π–∫–æ—Å—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞.<br>
                K<span class="sub">v</span> = ${K_v} ‚Äî –ø–æ–ø—Ä–∞–≤–æ—á–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç.<br>
                C<span class="sub">v</span> = ${Cv}; m = ${m}; x = ${x}; y = ${y}.<br>
                <br>
                V = ${Cv} / (${T_life}<span class="sup">${m}</span> ¬∑ ${t}<span class="sup">${x}</span> ¬∑ ${s}<span class="sup">${y}</span>) ¬∑ ${K_v} = <strong>${V_calc.toFixed(2)} –º/–º–∏–Ω.</strong>
            </div>

            <div class="report-section">
                <strong>4. –†–∞—Å—á–µ—Ç–Ω–æ–µ —á–∏—Å–ª–æ –æ–±–æ—Ä–æ—Ç–æ–≤:</strong><br>
                n = 1000 ¬∑ V / (œÄ ¬∑ D) = 1000 ¬∑ ${V_calc.toFixed(2)} / (3.14 ¬∑ ${D}) = <strong>${n_calc.toFixed(2)} –æ–±/–º–∏–Ω.</strong>
            </div>

            <div class="report-section">
                <strong>5. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ç–∞–Ω–∫—É:</strong><br>
                –ü—Ä–∏–Ω–∏–º–∞–µ–º –±–ª–∏–∂–∞–π—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –ø–∞—Å–ø–æ—Ä—Ç—É —Å—Ç–∞–Ω–∫–∞ 1–ö62:<br>
                <strong>n<span class="sub">—Å—Ç</span> = ${n_st} –æ–±/–º–∏–Ω;</strong> S<span class="sub">—Å—Ç</span> = ${s_st} –º–º/–æ–±.
            </div>

            <div class="report-section">
                <strong>6. –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–∑–∞–Ω–∏—è:</strong><br>
                V<span class="sub">–¥</span> = œÄ ¬∑ D ¬∑ n<span class="sub">—Å—Ç</span> / 1000 = 3.14 ¬∑ ${D} ¬∑ ${n_st} / 1000 = <strong>${V_act.toFixed(2)} –º/–º–∏–Ω.</strong>
            </div>

            <div class="report-section">
                <strong>7. –°–∏–ª–∞ —Ä–µ–∑–∞–Ω–∏—è P<span class="sub">z</span>:</strong><br>
                P<span class="sub">z</span> = 10 ¬∑ C<span class="sub">p</span> ¬∑ t<span class="sup">x</span> ¬∑ S<span class="sup">y</span> ¬∑ V<span class="sup">n</span> ¬∑ K<span class="sub">p</span>, –ù<br>
                <br>
                –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã: C<span class="sub">p</span>=${Cp}; x=${x_p}; y=${y_p}; n=${n_p}; K<span class="sub">p</span>=${Kp}.<br>
                <br>
                P<span class="sub">z</span> = 10 ¬∑ ${Cp} ¬∑ ${t}<span class="sup">${x_p}</span> ¬∑ ${s}<span class="sup">${y_p}</span> ¬∑ ${V_act.toFixed(2)}<span class="sup">${n_p}</span> ¬∑ ${Kp} = <strong>${Pz.toFixed(2)} –ù.</strong>
            </div>

            <div class="report-section">
                <strong>8. –ú–æ—â–Ω–æ—Å—Ç—å —Ä–µ–∑–∞–Ω–∏—è N<span class="sub">—Ä–µ–∑</span>:</strong><br>
                N<span class="sub">—Ä–µ–∑</span> = P<span class="sub">z</span> ¬∑ V<span class="sub">–¥</span> / (1020 ¬∑ 60) = ${Pz.toFixed(0)} ¬∑ ${V_act.toFixed(2)} / 61200 = <strong>${N_rez.toFixed(2)} –∫–í—Ç.</strong>
            </div>

            <div class="report-section">
                <strong>9. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –º–æ—â–Ω–æ—Å—Ç–∏:</strong><br>
                N<span class="sub">—Ä–µ–∑</span> (${N_rez.toFixed(2)} –∫–í—Ç) ‚â§ N<span class="sub">—Å—Ç</span> (${N_st} –∫–í—Ç) ‚Äî <span style="font-weight:bold; color:${N_rez <= N_st ? 'green' : 'red'}">${N_rez <= N_st ? '–£—Å–ª–æ–≤–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è' : '–ü–ï–†–ï–ì–†–£–ó–ö–ê!'}</span>.
            </div>

            <div class="report-section">
                <strong>10. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è T<span class="sub">o</span>:</strong><br>
                T<span class="sub">o</span> = L<span class="sub">–ø–æ–ª–Ω</span> / (n<span class="sub">—Å—Ç</span> ¬∑ S)<br>
                L<span class="sub">–ø–æ–ª–Ω</span> = ${L} + ${l_rez} + ${l_per} = ${L_total} –º–º.<br>
                T<span class="sub">o</span> = ${L_total} / (${n_st} ¬∑ ${s}) = <strong>${T_o.toFixed(3)} –º–∏–Ω.</strong>
            </div>
        `;

        document.getElementById('report-content').innerHTML = html;
    }

    // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    updateReport();
</script>

</body>
</html>
