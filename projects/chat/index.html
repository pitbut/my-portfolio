<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí¨ –°–≤–æ–±–æ–¥–Ω—ã–π —á–∞—Ç –º–∏–ª–ª–∏–∞—Ä–¥–µ—Ä–æ–≤</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .app-container {
            width: 100%;
            max-width: 1200px;
            height: 90vh;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: linear-gradient(135deg, #d4af37 0%, #f4d03f 100%);
            color: #1a1a2e;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .online-count {
            background: rgba(26, 26, 46, 0.2);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        .login-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px;
            background: linear-gradient(135deg, rgba(212, 175, 55, 0.1) 0%, rgba(244, 208, 63, 0.1) 100%);
        }

        .login-box {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }

        .login-box h2 {
            color: #1a1a2e;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .login-box p {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #d4af37;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }

        .btn-primary {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #d4af37 0%, #f4d03f 100%);
            color: #1a1a2e;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .chat-container {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .sidebar {
            width: 280px;
            background: #f8f9fa;
            border-right: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 20px;
            background: #1a1a2e;
            color: white;
        }

        .sidebar-header h3 {
            font-size: 16px;
            margin-bottom: 5px;
        }

        .user-info {
            font-size: 14px;
            color: #d4af37;
            font-weight: 600;
        }

        .users-list {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .user-item {
            padding: 12px;
            margin-bottom: 8px;
            background: white;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }

        .user-item:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #d4af37 0%, #f4d03f 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #1a1a2e;
        }

        .online-indicator {
            width: 10px;
            height: 10px;
            background: #4caf50;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .main-chat {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
            background: linear-gradient(to bottom, #ffffff 0%, #f8f9fa 100%);
        }

        .message {
            margin-bottom: 20px;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .message-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(135deg, #d4af37 0%, #f4d03f 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #1a1a2e;
            font-size: 14px;
        }

        .message-author {
            font-weight: 700;
            color: #1a1a2e;
        }

        .message-time {
            font-size: 12px;
            color: #999;
        }

        .message-content {
            margin-left: 45px;
            padding: 12px 16px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            word-wrap: break-word;
        }

        .message.own .message-content {
            background: linear-gradient(135deg, #d4af37 0%, #f4d03f 100%);
            color: #1a1a2e;
            font-weight: 500;
        }

        .input-container {
            padding: 20px 30px;
            background: white;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 15px;
        }

        .message-input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 15px;
            transition: all 0.3s;
        }

        .message-input:focus {
            outline: none;
            border-color: #d4af37;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }

        .send-button {
            padding: 15px 30px;
            background: linear-gradient(135deg, #d4af37 0%, #f4d03f 100%);
            color: #1a1a2e;
            border: none;
            border-radius: 25px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .send-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.4);
        }

        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .empty-chat {
            text-align: center;
            color: #999;
            padding: 40px;
        }

        .empty-chat-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .logout-button {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .logout-button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #999;
        }

        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
            
            .app-container {
                height: 95vh;
            }
        }

        .error-message {
            background: #ffebee;
            color: #c62828;
            padding: 12px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å localStorage
        const STORAGE_KEYS = {
            MESSAGES: 'chat_messages',
            USERS: 'chat_users',
            CURRENT_USER: 'chat_current_user'
        };

        const App = () => {
            const [currentUser, setCurrentUser] = useState(null);
            const [messages, setMessages] = useState([]);
            const [users, setUsers] = useState([]);
            const [messageText, setMessageText] = useState('');
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState('');
            const messagesEndRef = useRef(null);
            const updateIntervalRef = useRef(null);

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages]);

            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ localStorage
            const loadData = () => {
                try {
                    // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
                    const storedMessages = localStorage.getItem(STORAGE_KEYS.MESSAGES);
                    if (storedMessages) {
                        setMessages(JSON.parse(storedMessages));
                    } else {
                        setMessages([]);
                    }

                    // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                    const storedUsers = localStorage.getItem(STORAGE_KEYS.USERS);
                    if (storedUsers) {
                        const allUsers = JSON.parse(storedUsers);
                        // –§–∏–ª—å—Ç—Ä—É–µ–º –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–ø–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å < 5 –º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥)
                        const now = Date.now();
                        const activeUsers = allUsers.filter(u => (now - u.lastActive) < 300000);
                        setUsers(activeUsers);
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ
                        if (activeUsers.length !== allUsers.length) {
                            localStorage.setItem(STORAGE_KEYS.USERS, JSON.stringify(activeUsers));
                        }
                    } else {
                        setUsers([]);
                    }
                } catch (err) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', err);
                }
            };

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const updateUserActivity = () => {
                if (!currentUser) return;

                try {
                    const storedUsers = localStorage.getItem(STORAGE_KEYS.USERS);
                    let allUsers = storedUsers ? JSON.parse(storedUsers) : [];
                    
                    const userIndex = allUsers.findIndex(u => u.name === currentUser);
                    if (userIndex !== -1) {
                        allUsers[userIndex].lastActive = Date.now();
                    } else {
                        allUsers.push({
                            name: currentUser,
                            joinedAt: Date.now(),
                            lastActive: Date.now()
                        });
                    }

                    localStorage.setItem(STORAGE_KEYS.USERS, JSON.stringify(allUsers));
                } catch (err) {
                    console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:', err);
                }
            };

            // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
            useEffect(() => {
                const savedUser = localStorage.getItem(STORAGE_KEYS.CURRENT_USER);
                if (savedUser) {
                    setCurrentUser(savedUser);
                }
            }, []);

            // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
            useEffect(() => {
                if (currentUser) {
                    loadData();
                    updateUserActivity();
                    
                    updateIntervalRef.current = setInterval(() => {
                        loadData();
                        updateUserActivity();
                    }, 2000);

                    return () => {
                        if (updateIntervalRef.current) {
                            clearInterval(updateIntervalRef.current);
                        }
                    };
                }
            }, [currentUser]);

            // –í—Ö–æ–¥ –≤ —á–∞—Ç
            const handleLogin = (name) => {
                if (!name.trim()) {
                    setError('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è');
                    return;
                }

                setLoading(true);
                setError('');
                
                try {
                    // –ü—Ä–æ–≤–µ—Ä–∫–∞, –Ω–µ –∑–∞–Ω—è—Ç–æ –ª–∏ –∏–º—è
                    const storedUsers = localStorage.getItem(STORAGE_KEYS.USERS);
                    const existingUsers = storedUsers ? JSON.parse(storedUsers) : [];
                    const now = Date.now();
                    const activeUsers = existingUsers.filter(u => (now - u.lastActive) < 300000);
                    
                    if (activeUsers.some(u => u.name === name.trim())) {
                        setError('–≠—Ç–æ –∏–º—è —É–∂–µ –∑–∞–Ω—è—Ç–æ. –í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–µ.');
                        setLoading(false);
                        return;
                    }

                    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    activeUsers.push({
                        name: name.trim(),
                        joinedAt: Date.now(),
                        lastActive: Date.now()
                    });

                    localStorage.setItem(STORAGE_KEYS.USERS, JSON.stringify(activeUsers));
                    localStorage.setItem(STORAGE_KEYS.CURRENT_USER, name.trim());
                    setCurrentUser(name.trim());
                    
                    // –°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –≤—Ö–æ–¥–µ
                    const storedMessages = localStorage.getItem(STORAGE_KEYS.MESSAGES);
                    const currentMessages = storedMessages ? JSON.parse(storedMessages) : [];
                    
                    currentMessages.push({
                        id: Date.now(),
                        author: '–°–∏—Å—Ç–µ–º–∞',
                        text: `${name.trim()} –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª—Å—è –∫ —á–∞—Ç—É`,
                        timestamp: Date.now(),
                        isSystem: true
                    });

                    localStorage.setItem(STORAGE_KEYS.MESSAGES, JSON.stringify(currentMessages));
                    loadData();
                } catch (err) {
                    setError('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ –≤ —á–∞—Ç. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.');
                    console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', err);
                } finally {
                    setLoading(false);
                }
            };

            // –í—ã—Ö–æ–¥ –∏–∑ —á–∞—Ç–∞
            const handleLogout = () => {
                if (!currentUser) return;

                try {
                    // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Å–ø–∏—Å–∫–∞
                    const storedUsers = localStorage.getItem(STORAGE_KEYS.USERS);
                    const allUsers = storedUsers ? JSON.parse(storedUsers) : [];
                    const filteredUsers = allUsers.filter(u => u.name !== currentUser);
                    localStorage.setItem(STORAGE_KEYS.USERS, JSON.stringify(filteredUsers));

                    // –°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –≤—ã—Ö–æ–¥–µ
                    const storedMessages = localStorage.getItem(STORAGE_KEYS.MESSAGES);
                    const currentMessages = storedMessages ? JSON.parse(storedMessages) : [];
                    
                    currentMessages.push({
                        id: Date.now(),
                        author: '–°–∏—Å—Ç–µ–º–∞',
                        text: `${currentUser} –ø–æ–∫–∏–Ω—É–ª —á–∞—Ç`,
                        timestamp: Date.now(),
                        isSystem: true
                    });

                    localStorage.setItem(STORAGE_KEYS.MESSAGES, JSON.stringify(currentMessages));
                    localStorage.removeItem(STORAGE_KEYS.CURRENT_USER);
                    
                    setCurrentUser(null);
                    setMessages([]);
                    setUsers([]);
                } catch (err) {
                    console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', err);
                }
            };

            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
            const handleSendMessage = () => {
                if (!messageText.trim() || !currentUser) return;

                try {
                    const storedMessages = localStorage.getItem(STORAGE_KEYS.MESSAGES);
                    const currentMessages = storedMessages ? JSON.parse(storedMessages) : [];
                    
                    const newMessage = {
                        id: Date.now(),
                        author: currentUser,
                        text: messageText.trim(),
                        timestamp: Date.now(),
                        isSystem: false
                    };

                    currentMessages.push(newMessage);
                    
                    // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: —Ö—Ä–∞–Ω–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π
                    const limitedMessages = currentMessages.slice(-100);
                    
                    localStorage.setItem(STORAGE_KEYS.MESSAGES, JSON.stringify(limitedMessages));
                    setMessageText('');
                    
                    // –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                    loadData();
                } catch (err) {
                    setError('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è');
                    console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:', err);
                }
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    handleSendMessage();
                }
            };

            const formatTime = (timestamp) => {
                const date = new Date(timestamp);
                return date.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
            };

            const getInitials = (name) => {
                return name.charAt(0).toUpperCase();
            };

            // –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞
            if (!currentUser) {
                return (
                    <LoginScreen 
                        onLogin={handleLogin} 
                        loading={loading}
                        error={error}
                    />
                );
            }

            // –û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç
            return (
                <div className="app-container">
                    <div className="header">
                        <h1>
                            <span>üí¨</span>
                            <span>–°–≤–æ–±–æ–¥–Ω—ã–π —á–∞—Ç –º–∏–ª–ª–∏–∞—Ä–¥–µ—Ä–æ–≤</span>
                        </h1>
                        <div style={{ display: 'flex', gap: '15px', alignItems: 'center' }}>
                            <div className="online-count">
                                üë• –û–Ω–ª–∞–π–Ω: {users.length}
                            </div>
                            <button className="logout-button" onClick={handleLogout}>
                                –í—ã–π—Ç–∏
                            </button>
                        </div>
                    </div>

                    <div className="chat-container">
                        <div className="sidebar">
                            <div className="sidebar-header">
                                <h3>–£—á–∞—Å—Ç–Ω–∏–∫–∏ —á–∞—Ç–∞</h3>
                                <div className="user-info">–í—ã: {currentUser}</div>
                            </div>
                            <div className="users-list">
                                {users.map((user, index) => (
                                    <div key={index} className="user-item">
                                        <div className="user-avatar">
                                            {getInitials(user.name)}
                                        </div>
                                        <div style={{ flex: 1 }}>
                                            <div style={{ fontWeight: '600', color: '#1a1a2e' }}>
                                                {user.name}
                                                {user.name === currentUser && ' (–í—ã)'}
                                            </div>
                                        </div>
                                        <div className="online-indicator" />
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="main-chat">
                            <div className="messages-container">
                                {messages.length === 0 ? (
                                    <div className="empty-chat">
                                        <div className="empty-chat-icon">üí≠</div>
                                        <div>–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</div>
                                        <div style={{ fontSize: '14px', marginTop: '5px' }}>
                                            –ù–∞—á–Ω–∏—Ç–µ –±–µ—Å–µ–¥—É!
                                        </div>
                                    </div>
                                ) : (
                                    messages.map((msg) => (
                                        <div 
                                            key={msg.id} 
                                            className={`message ${msg.author === currentUser ? 'own' : ''} ${msg.isSystem ? 'system' : ''}`}
                                        >
                                            {msg.isSystem ? (
                                                <div style={{ 
                                                    textAlign: 'center', 
                                                    color: '#999', 
                                                    fontSize: '14px',
                                                    fontStyle: 'italic'
                                                }}>
                                                    {msg.text}
                                                </div>
                                            ) : (
                                                <>
                                                    <div className="message-header">
                                                        <div className="message-avatar">
                                                            {getInitials(msg.author)}
                                                        </div>
                                                        <div className="message-author">
                                                            {msg.author}
                                                        </div>
                                                        <div className="message-time">
                                                            {formatTime(msg.timestamp)}
                                                        </div>
                                                    </div>
                                                    <div className="message-content">
                                                        {msg.text}
                                                    </div>
                                                </>
                                            )}
                                        </div>
                                    ))
                                )}
                                <div ref={messagesEndRef} />
                            </div>

                            {error && (
                                <div className="error-message">{error}</div>
                            )}

                            <div className="input-container">
                                <input
                                    type="text"
                                    className="message-input"
                                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
                                    value={messageText}
                                    onChange={(e) => setMessageText(e.target.value)}
                                    onKeyPress={handleKeyPress}
                                />
                                <button 
                                    className="send-button"
                                    onClick={handleSendMessage}
                                    disabled={!messageText.trim()}
                                >
                                    –û—Ç–ø—Ä–∞–≤–∏—Ç—å
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const LoginScreen = ({ onLogin, loading, error }) => {
            const [name, setName] = useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                onLogin(name);
            };

            return (
                <div className="app-container">
                    <div className="header">
                        <h1>
                            <span>üí¨</span>
                            <span>–°–≤–æ–±–æ–¥–Ω—ã–π —á–∞—Ç –º–∏–ª–ª–∏–∞—Ä–¥–µ—Ä–æ–≤</span>
                        </h1>
                    </div>
                    <div className="login-container">
                        <div className="login-box">
                            <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>
                            <p>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —á–∞—Ç</p>
                            {error && (
                                <div className="error-message">{error}</div>
                            )}
                            <form onSubmit={handleSubmit}>
                                <div className="input-group">
                                    <input
                                        type="text"
                                        placeholder="–í–∞—à–µ –∏–º—è"
                                        value={name}
                                        onChange={(e) => setName(e.target.value)}
                                        maxLength={20}
                                        disabled={loading}
                                        autoFocus
                                    />
                                </div>
                                <button 
                                    type="submit" 
                                    className="btn-primary"
                                    disabled={loading || !name.trim()}
                                >
                                    {loading ? '–í—Ö–æ–¥...' : '–í–æ–π—Ç–∏ –≤ —á–∞—Ç'}
                                </button>
                            </form>
                            <div style={{ marginTop: '20px', padding: '15px', background: 'rgba(212, 175, 55, 0.1)', borderRadius: '10px', fontSize: '13px', color: '#666' }}>
                                <strong>‚ÑπÔ∏è –î–µ–º–æ-—Ä–µ–∂–∏–º:</strong>
                                <div style={{ marginTop: '8px' }}>
                                    ‚Ä¢ –ß–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ<br/>
                                    ‚Ä¢ –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –æ–±—â–µ–Ω–∏—è –Ω—É–∂–µ–Ω —Å–µ—Ä–≤–µ—Ä<br/>
                                    ‚Ä¢ –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∫–ª–∞–¥–∫–∞—Ö –¥–ª—è —Ç–µ—Å—Ç–∞
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
